---
import { Icon } from 'astro-icon/components'
import { Image } from 'astro:assets'
import { getCollection } from 'astro:content'

const arts = await getCollection('arts')
---

<script>
    import { track } from '@vercel/analytics'

    document.addEventListener('DOMContentLoaded', () => {
        const artLinks = document.querySelectorAll('a.art-thumbnail')

        artLinks.forEach((link) => {
            link.addEventListener('click', () => {
                const imgAlt =
                    link.querySelector('img')?.getAttribute('alt') || 'Unknown'
                track('Art click', { art: imgAlt })
            })
        })
    })
</script>

<div class="grid w-full grid-cols-2 gap-3 sm:grid-cols-4">
    {
        arts.map((art) => (
            <a
                href={art.data.url}
                target="_blank"
                class="art-thumbnail group relative overflow-hidden rounded-lg"
            >
                <Image
                    src={art.data.src}
                    alt={art.data.alt}
                    width={256}
                    height={256}
                    loading="lazy"
                    fit="cover"
                    class="h-32 w-full shrink-0 object-cover"
                />
                <div class="absolute inset-0 flex items-center justify-center bg-black/60 opacity-0 transition-opacity group-hover:opacity-100 group-focus-visible:opacity-100">
                    <Icon
                        name="simple-icons:artstation"
                        size={24}
                        class="text-zinc-100"
                    />
                </div>
            </a>
        ))
    }
</div>
